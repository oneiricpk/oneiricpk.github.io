function getDimension(a,b){if(a===window){var c=a.document.documentElement["client"+b],d=a.document.body;return"CSS1Compat"===a.document.compatMode&&c||d&&d["client"+b]||c}return Math.max(a.documentElement["client"+b],a.body["scroll"+b],a.documentElement["scroll"+b],a.body["offset"+b],a.documentElement["offset"+b])}var merge=function(a,b){for(prop in a)prop in b||(b[prop]=a[prop])},Baseliner=function(a){var b={gridColor:[196,196,196],gridHeight:10,gridOpacity:100,gridSpace:1};if(null==a)a={};else{var c=parseInt(a);0==c||isNaN(c)||(a={gridHeight:c})}merge(b,a),this.opts=a;var d=this;this.overlay_id="baseline-overlay",this.overlay=null,this.showText=document.createTextNode("Show Baseline"),this.hideText=document.createTextNode("Hide Baseline"),this.resize=function(){this.overlay&&(height=getDimension(document,"Height"),width=getDimension(window,"Width"),this.overlay.style.width=width+"px",this.overlay.style.height=height+"px")},this.create=function(){var a=document.getElementById(this.overlay_id);a||(this.overlay=document.createElement("div"),this.overlay.id=this.overlay_id,document.body.appendChild(this.overlay),this.overlay.style.background="url(http://baselinebg.keyes.ie/?h="+this.opts.gridHeight+"&r="+this.opts.gridColor[0]+"&g="+this.opts.gridColor[1]+"&b="+this.opts.gridColor[2]+"&s="+this.opts.gridSpace+") repeat",this.overlay.style.position="absolute",this.overlay.style.top="0px",this.overlay.style.left="0px",this.overlay.style.zIndex=9998,this.overlay.style.opacity=this.opts.gridOpacity/100,this.resize())},this.toggle=function(a){if(a){var b=document.getElementById(this.overlay_id);b&&document.body.removeChild(b)}this.create(),a||"block"!=this.overlay.style.display?(this.showText.parentNode&&this.overlay_it.replaceChild(this.hideText,this.showText),this.overlay.style.display="block"):(this.hideText.parentNode&&this.overlay_it.replaceChild(this.showText,this.hideText),this.overlay.style.display="none")},this.refresh=function(a){var a=parseInt(a);return 0==a||isNaN(a)?(this.value=d.opts.gridHeight,d.grid_size.style.backgroundColor="red",void(d.grid_size.style.color="white")):(d.grid_size.style.backgroundColor="white",d.grid_size.style.color="black",d.overlay&&(document.body.removeChild(d.overlay),d.overlay=null),d.opts.gridHeight=a,void d.toggle(!0))},init=function(){switch(d.opts.gridColor){case"green":d.opts.gridColor=[0,255,0];break;case"blue":d.opts.gridColor=[0,0,255];break;case"red":d.opts.gridColor=[255,0,0];break;case"black":d.opts.gridColor=[0,0,0]}var a=document.createElement("a");a.setAttribute("href",""),a.style.color="#EEE",a.style.marginRight="12px",a.appendChild(d.showText),a.onclick=function(a){if(!a)var a=window.event;return d.toggle(),a.cancelBubble=!0,a.stopPropagation&&(a.stopPropagation(),a.preventDefault()),!1},d.overlay_it=a;var b=document.createElement("input");b.size=3,b.value=d.opts.gridHeight,b.style.textAlign="center",b.style.border="1px solid #CCC",b.style.padding="1px",d.grid_size=b;var c=document.createElement("div");c.style.position="relative",c.style.zIndex=2e4,c.style.marginTop="20px";var e=document.createElement("div");e.id="overlay-it",e.style.position="fixed",e.style.bottom="0px",e.style.left="10px",e.style.display="inline",e.style.padding="5px 15px",e.style.fontFamily="Arial, sans-serif",e.style.fontSize="12px",e.style.fontWeight="bold",e.style.textAlign="center",e.style.backgroundColor="#333",e.style.color="#EEE",e.appendChild(a),e.appendChild(b),c.appendChild(e),document.body.appendChild(c);var f,g=function(){window.clearTimeout(f),f=window.setTimeout(function(){d.refresh(b.value)},400)};b.onchange=b.onkeyup=g,window.onresize=function(){d.resize()},document.onkeyup=function(a){if(!b)var b=window.event;var c=b.keyCode||b.which;27==c&&(window.clearTimeout(f),f=window.setTimeout(function(){d.toggle()},400))}},init()};